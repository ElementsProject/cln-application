export const ListPeerChannelsSQL = "SELECT n.alias as node_alias, pc.peer_id, pc.channel_id, pc.short_channel_id, pc.state, pc.peer_connected, pc.to_us_msat, pc.total_msat, pc.their_to_self_delay, pc.opener, pc.private, pc.dust_limit_msat, pc.spendable_msat, pc.receivable_msat, pc.funding_txid FROM peerchannels pc LEFT JOIN nodes n ON pc.peer_id = n.nodeid;";

export const listBTCTransactionsSQL = (offset) => "WITH unique_timestamps AS (SELECT DISTINCT timestamp FROM bkpr_accountevents WHERE account = 'wallet' AND (tag = 'deposit' OR tag = 'withdrawal') ORDER BY timestamp LIMIT 10 OFFSET " + offset + ") SELECT e.tag, e.blockheight, e.timestamp, e.credit_msat, e.debit_msat, e.outpoint, e.txid FROM bkpr_accountevents e INNER JOIN unique_timestamps ut ON e.timestamp = ut.timestamp WHERE e.account = 'wallet' AND (e.tag = 'deposit' OR e.tag = 'withdrawal') ORDER BY e.timestamp DESC;";

export const listCLNTransactionsSQL = (offset) => "WITH unique_payment_hashes AS (SELECT payment_hash, created_at as sort_time FROM (SELECT DISTINCT payment_hash, MAX(created_at) as created_at FROM sendpays GROUP BY payment_hash)), unique_invoice_hashes AS (SELECT payment_hash, COALESCE(paid_at, expires_at) as sort_time FROM invoices WHERE status != 'expired'), all_unique_hashes AS (SELECT payment_hash, sort_time FROM unique_payment_hashes UNION ALL SELECT payment_hash, sort_time FROM unique_invoice_hashes), paginated_hashes AS (SELECT DISTINCT payment_hash FROM all_unique_hashes ORDER BY sort_time DESC LIMIT 10 OFFSET " + offset + ") SELECT 'INVOICE' as type, i.created_index, i.updated_index, i.pay_index, i.local_offer_id, i.payment_hash, i.label, i.description, i.bolt11, i.bolt12, i.payment_preimage, i.status, i.amount_msat, i.amount_received_msat, i.paid_outpoint_txid, i.paid_outpoint_outnum, i.paid_at, i.expires_at, NULL as created_at, COALESCE(i.paid_at, i.expires_at) as sort_time FROM invoices i INNER JOIN paginated_hashes ph ON i.payment_hash = ph.payment_hash WHERE i.status != 'expired' UNION ALL SELECT 'PAYMENT' as type, s.created_index, s.updated_index, s.groupid, s.partid, s.payment_hash, s.label, s.description, s.bolt11, s.bolt12, s.payment_preimage, s.status, s.destination, s.amount_msat, s.amount_sent_msat, NULL as paid_at, NULL as expires_at, s.completed_at, s.created_at, s.created_at as sort_time FROM sendpays s INNER JOIN paginated_hashes ph ON s.payment_hash = ph.payment_hash ORDER BY sort_time DESC;";

export const ListOffersSQL = (offset) => "SELECT * FROM offers ORDER BY offer_id LIMIT 10 OFFSET " + offset;
