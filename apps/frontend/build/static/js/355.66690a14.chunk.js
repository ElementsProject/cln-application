"use strict";(self.webpackChunkcln_application_frontend=self.webpackChunkcln_application_frontend||[]).push([[355],{121:(e,s,t)=>{t.d(s,{c:()=>c});t(16);var a=t(7374),n=t(776),i=t(8277),l=t(76);const c=e=>{var s,t,c,r;return(0,l.jsx)(a.A,{placement:"auto",delay:{show:250,hide:250},overlay:"withdrawal"===(null===(s=e.txStatus)||void 0===s?void 0:s.toLowerCase())?(0,l.jsx)(l.Fragment,{}):(0,l.jsx)(n.A,{children:"complete"===(null===(t=e.txStatus)||void 0===t?void 0:t.toLowerCase())?"Paid":(0,i.nx)(e.txStatus)}),children:(0,l.jsxs)("svg",{className:e.className,width:"42",height:"42",viewBox:"0 0 42 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("circle",{cx:"21",cy:"21",r:"21",className:"fill-body-bg"}),(0,l.jsx)("path",{d:"M13.3891 30L12 28.6109L25.6265 14.9844H13.1245V13H29V28.8755H27.0156V16.3735L13.3891 30Z",className:"withdrawal"===(null===(c=e.txStatus)||void 0===c?void 0:c.toLowerCase())||"complete"===(null===(r=e.txStatus)||void 0===r?void 0:r.toLowerCase())?"fill-warning":"fill-light"})]})})}},1587:(e,s,t)=>{t.d(s,{A:()=>c});var a=t(7374),n=t(776),i=t(8277),l=t(76);const c=e=>(0,l.jsx)(a.A,{placement:"top",delay:{show:250,hide:250},overlay:e.showTooltip?(0,l.jsx)(n.A,{"data-testid":"tooltip",children:e.dataType}):(0,l.jsx)(l.Fragment,{}),children:(0,l.jsx)("div",{className:e.className,"data-testid":"overlay-trigger",children:(0,i.l_)(e.dataValue)})})},4355:(e,s,t)=>{t.r(s),t.d(s,{CLNTransactionsList:()=>P,default:()=>U});var a=t(16),n=t(5134),i=t(3580),l=t(763),c=t(13),r=t(7630),o=t(8698),d=t(6531),x=t.n(d),m=t(8277),p=t(2527),h=t(121),j=t(1587),u=t(6034),f=t(7888),v=t(1349),g=t(3162),A=t(9662),N=t(9646),y=t(76);const w=e=>{let{payment:s,copyHandler:t}=e;return(0,y.jsxs)(y.Fragment,{children:[s.amount_msat?(0,y.jsxs)(l.A,{className:"cln-transaction-detail",children:[(0,y.jsx)(c.A,{xs:12,className:"fs-7 text-light",children:"Transaction Fee (mSats)"}),(0,y.jsx)(c.A,{xs:11,className:"fs-7 overflow-x-ellipsis",children:s.amount_sent_msat?(0,m.vv)(s.amount_sent_msat-s.amount_msat,f.WU.MSATS,f.WU.MSATS,!1,0,"string"):0})]}):(0,y.jsx)(y.Fragment,{}),s.bolt11||s.bolt12?(0,y.jsxs)(l.A,{className:"cln-transaction-detail",children:[(0,y.jsx)(c.A,{xs:12,className:"fs-7 text-light",children:"Invoice"}),(0,y.jsx)(c.A,{xs:11,className:"pe-1 fs-7 overflow-x-ellipsis",children:s.bolt11||s.bolt12}),(0,y.jsx)(c.A,{xs:1,onClick:t,className:"cln-transaction-copy",children:(0,y.jsx)(v.G,{id:"Invoice",showTooltip:!0})})]}):(0,y.jsx)(y.Fragment,{}),s.payment_preimage?(0,y.jsxs)(l.A,{className:"cln-transaction-detail",children:[(0,y.jsx)(c.A,{xs:12,className:"fs-7 text-light",children:"Preimage"}),(0,y.jsx)(c.A,{xs:11,className:"pe-1 fs-7 overflow-x-ellipsis",children:s.payment_preimage}),(0,y.jsx)(c.A,{xs:1,onClick:t,className:"cln-transaction-copy",children:(0,y.jsx)(v.G,{id:"Preimage",showTooltip:!0})})]}):(0,y.jsx)(y.Fragment,{})]})},_=e=>{let{invoice:s,copyHandler:t}=e;return(0,y.jsxs)(y.Fragment,{children:[s.paid_at&&s.expires_at&&s.expires_at>f.Es?(0,y.jsxs)(l.A,{className:"cln-transaction-detail","data-testid":"valid-till",children:[(0,y.jsx)(c.A,{xs:12,className:"fs-7 text-light",children:"Valid till"}),(0,y.jsx)(c.A,{xs:11,className:"fs-7 overflow-x-ellipsis",children:(0,y.jsx)(j.A,{dataValue:s.expires_at,dataType:"",showTooltip:!1})})]}):(0,y.jsx)(y.Fragment,{}),s.bolt11||s.bolt12?(0,y.jsxs)(l.A,{className:"cln-transaction-detail","data-testid":"invoice",children:[(0,y.jsx)(c.A,{xs:12,className:"fs-7 text-light",children:"Invoice"}),(0,y.jsx)(c.A,{xs:11,className:"pe-1 fs-7 overflow-x-ellipsis",children:s.bolt11||s.bolt12}),(0,y.jsx)(c.A,{xs:1,onClick:t,className:"cln-transaction-copy",children:(0,y.jsx)(v.G,{id:"Invoice",showTooltip:!0})})]}):(0,y.jsx)(y.Fragment,{}),s.payment_preimage?(0,y.jsxs)(l.A,{className:"cln-transaction-detail","data-testid":"preimage",children:[(0,y.jsx)(c.A,{xs:12,className:"fs-7 text-light",children:"Preimage"}),(0,y.jsx)(c.A,{xs:11,className:"pe-1 fs-7 overflow-x-ellipsis",children:s.payment_preimage}),(0,y.jsx)(c.A,{xs:1,onClick:t,className:"cln-transaction-copy",children:(0,y.jsx)(v.G,{id:"Preimage",showTooltip:!0})})]}):(0,y.jsx)(y.Fragment,{})]})},b=e=>{var s;const t=(0,N.wA)(),a=s=>{let a="";switch(s.target.id){case"Destination":a=e.transaction.destination;break;case"Invoice":a=e.transaction.bolt11||e.transaction.bolt12;break;case"Preimage":a=e.transaction.payment_preimage;break;default:a=e.transaction.payment_hash}(0,m.eM)(a).then((()=>{t((0,A.Fs)({show:!0,message:s.target.id+" Copied Successfully!",bg:"success"}))})).catch((e=>{g.A.error(e)}))};return(0,y.jsx)(n.P.div,{variants:{collapsed:{scale:.8,opacity:0},open:{scale:1,opacity:1}},transition:{duration:f.xt},className:"cln-transaction-placeholder pb-2",children:"payment"===(null===(s=e.transaction.type)||void 0===s?void 0:s.toLowerCase())?(0,y.jsx)(w,{payment:e.transaction,copyHandler:a}):(0,y.jsx)(_,{invoice:e.transaction,copyHandler:a})})};var T=t(9238),S=t(7696),C=t(5670),k=t(7439);const F=e=>{var s;let{payment:t}=e;const a=(0,N.d4)(C.th),n=(0,N.d4)(C.T_),i=(0,N.d4)(C.ZV);return(0,y.jsxs)(l.A,{className:"transaction-list-item d-flex justify-content-between align-items-center","data-testid":"payment-header",children:[(0,y.jsx)(c.A,{xs:2,children:(0,y.jsx)(h.c,{className:"me-1",txStatus:t.status})}),(0,y.jsxs)(c.A,{xs:10,children:[(0,y.jsxs)(l.A,{className:"d-flex justify-content-between align-items-center",children:[(0,y.jsx)(c.A,{xs:7,className:"ps-2 d-flex align-items-center",children:(0,y.jsx)("span",{className:"text-dark fw-bold overflow-x-ellipsis",children:t.description||t.payment_hash})}),(0,y.jsx)(c.A,{xs:5,className:"ps-0 d-flex align-items-center justify-content-end fw-bold text-darker-blue",children:"complete"===(null===(s=t.status)||void 0===s?void 0:s.toLowerCase())?"-"+(0,m.vv)(t.amount_sent_msat||0,f.WU.MSATS,n,!1,0,"string"):0})]}),(0,y.jsxs)(l.A,{className:"d-flex justify-content-between align-items-center",children:[(0,y.jsxs)(c.A,{xs:8,className:"ps-2 pe-0 fs-7 text-light d-flex flex-row",children:[(0,y.jsx)("span",{className:"me-1",children:"Created at"}),(0,y.jsx)(j.A,{dataValue:t.created_at,dataType:"Created At",showTooltip:!1})]}),(0,y.jsx)(c.A,{xs:4,className:"ps-0 fs-7 text-light d-flex align-items-center justify-content-end",children:(0,y.jsx)(u.A,{value:t.amount_sent_msat||0,fiatUnit:a,fromUnit:f.WU.MSATS,symbol:i.symbol,rate:i.rate})})]})]})]})},L=e=>{let{invoice:s}=e;const t=(0,N.d4)(C.th),a=(0,N.d4)(C.T_),n=(0,N.d4)(C.ZV);return(0,y.jsxs)(l.A,{className:"transaction-list-item d-flex justify-content-between align-items-center","data-testid":"invoice-header",children:[(0,y.jsx)(c.A,{xs:2,children:(0,y.jsx)(p.O,{className:"me-1",txStatus:s.status})}),(0,y.jsxs)(c.A,{xs:10,children:[(0,y.jsxs)(l.A,{className:"d-flex justify-content-between align-items-center",children:[(0,y.jsx)(c.A,{xs:7,className:"ps-2 d-flex align-items-center",children:(0,y.jsx)("span",{className:"text-dark fw-bold overflow-x-ellipsis",children:s.description||s.payment_hash})}),(0,y.jsx)(c.A,{xs:5,className:"ps-0 d-flex align-items-center justify-content-end fw-bold text-darker-blue",children:s.paid_at?(0,y.jsx)("span",{children:"+"+(0,m.vv)(s.amount_received_msat||0,f.WU.MSATS,a,!1,8,"string")}):(0,m.vv)(s.amount_msat||0,f.WU.MSATS,a,!1,8,"string")})]}),(0,y.jsxs)(l.A,{className:"d-flex justify-content-between align-items-center",children:[(0,y.jsxs)(c.A,{xs:8,className:"ps-2 pe-0 fs-7 text-light d-flex flex-row align-items-center",children:[s.paid_at?(0,y.jsx)("span",{className:"me-1",children:"Paid at"}):s.expires_at>f.Es?(0,y.jsx)("span",{className:"me-1 text-valid",children:"Valid till"}):(0,y.jsx)("span",{className:"me-1 text-invalid",children:"Expired at"}),(0,y.jsx)(j.A,{dataValue:s.paid_at?s.paid_at:s.expires_at,dataType:"",showTooltip:!1})]}),(0,y.jsx)(c.A,{xs:4,className:"ps-0 fs-7 text-light d-flex align-items-center justify-content-end",children:(0,y.jsx)(u.A,{value:s.paid_at?s.amount_received_msat:s.amount_msat,fromUnit:f.WU.MSATS,fiatUnit:t,symbol:n.symbol,rate:n.rate})})]})]})]})},E=e=>{var s;let{i:t,expanded:a,setExpanded:l,initExpansions:c,transaction:r}=e;const o=(0,N.d4)(C.SZ);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(n.P.div,{"data-testid":"cln-transaction-header",className:"cln-transaction-header "+(a[t]?"expanded":""),initial:!1,animate:{backgroundColor:o?a[t]?"#0C0C0F":"#2A2A2C":a[t]?"#EBEFF9":"#FFFFFF"},transition:{duration:f.xt},onClick:()=>(c[t]=!a[t],l(c)),children:"payment"===(null===(s=r.type)||void 0===s?void 0:s.toLowerCase())?(0,y.jsx)(F,{payment:r}):(0,y.jsx)(L,{invoice:r})}),(0,y.jsx)(i.N,{initial:!1,children:a[t]&&(0,y.jsx)(n.P.div,{className:"cln-transaction-details",initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:f.xt,ease:[.4,.52,.83,.98]},children:(0,y.jsx)(b,{transaction:r})},"content")})]})},P=()=>{var e;const s=(0,N.d4)(C.SZ),t=(0,N.d4)(C.Kc),n=(0,N.d4)(C.YG),i=(0,N.d4)(k.mW),d=(null===(e=i.clnTransactions)||void 0===e?void 0:e.reduce((e=>[...e,!1]),[]))||[],[m,p]=(0,a.useState)(d),[h,j]=(0,a.useState)([]),[u,v]=(0,a.useState)(0),[g,A]=(0,a.useState)(!1),[w,_]=(0,a.useState)(!1),b=(0,a.useRef)(null),F=(0,a.useCallback)((e=>{e&&(b.current=e)}),[]);(0,a.useEffect)((()=>{var e;if((null===i||void 0===i||null===(e=i.clnTransactions)||void 0===e?void 0:e.length)>0){const e=i.clnTransactions.slice(0,f.Tr);j(e),v(f.Tr),f.Tr>=i.clnTransactions.length&&_(!0)}}),[i]);const L=(0,a.useCallback)((()=>{g||w||(A(!0),setTimeout((()=>{const e=u+f.Tr,s=i.clnTransactions.slice(u,e);j((e=>[...e,...s])),v(e),e>=i.clnTransactions.length&&_(!0),A(!1)}),300))}),[u,g,w,i]),P=(0,a.useCallback)((e=>{if(!e||g||w)return;const{scrollTop:s,scrollHeight:t,clientHeight:a}=e;t-s-a<f.q2&&L()}),[g,w,L]);return(0,a.useEffect)((()=>{const e=b.current;if(e)return null===e||void 0===e||e.addEventListener("scroll",P),()=>null===e||void 0===e?void 0:e.removeEventListener("scroll",P)}),[P]),t&&i.isLoading?(0,y.jsx)("span",{className:"h-100 d-flex justify-content-center align-items-center",children:(0,y.jsx)(r.A,{animation:"grow",variant:"primary","data-testid":"cln-transactions-list-spinner"})}):i.error?(0,y.jsx)(o.A,{className:"py-0 px-1 fs-7",variant:"danger","data-testid":"cln-transactions-list-error",children:i.error}):null!==i&&void 0!==i&&i.clnTransactions&&null!==i&&void 0!==i&&i.clnTransactions.length&&(null===i||void 0===i?void 0:i.clnTransactions.length)>0?(0,y.jsxs)(x(),{containerRef:F,onScrollY:P,className:"cln-transactions-list","data-testid":"cln-transactions-list",options:{suppressScrollX:!0,wheelPropagation:!1},children:[h.map(((e,s)=>(0,y.jsx)(E,{i:s,expanded:m,setExpanded:p,initExpansions:d,transaction:e},s))),g&&(0,y.jsx)(c.A,{xs:12,className:"d-flex align-items-center justify-content-center mb-5",children:(0,y.jsx)(r.A,{animation:"grow",variant:"primary"})}),w&&(null===i||void 0===i?void 0:i.clnTransactions.length)>100&&(0,y.jsx)("h6",{className:"d-flex align-self-center py-4 text-muted",children:"No more transactions to load!"})]}):(0,y.jsx)(l.A,{className:"text-light fs-6 h-75 mt-5 align-items-center justify-content-center",children:(0,y.jsxs)(l.A,{className:"d-flex align-items-center justify-content-center mt-2",children:[s?(0,y.jsx)(S.p,{className:"no-clntx-dark pb-1"}):(0,y.jsx)(T.t,{className:"no-clntx-light pb-1"}),(0,y.jsx)(l.A,{className:"text-center",children:n?"No transaction found. Click send/receive to start!":"No transaction found. Open channel to start!"})]})})},U=P}}]);